<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üî† Mots Crois√©s</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="stylesheet" href="../../shared/css/modals.css">
    <link rel="stylesheet" href="../../shared/css/game-rating.css">
    <link rel="stylesheet" href="../../shared/css/game-help-modal.css">
    <link rel="stylesheet" href="../../shared/css/theme.css">
    <link rel="stylesheet" href="../../shared/css/navigation.css">
    <link rel="stylesheet" href="../../shared/css/page-header.css">
    <link rel="stylesheet" href="../../shared/css/reward-badge.css">
    <link rel="stylesheet" href="../../shared/css/victory-animation.css">
    <link rel="stylesheet" href="css/crossword.css">
    <link rel="stylesheet" href="css/config-modal.css">
</head>
<body>
    <div class="container">
        <!-- Header inject√© automatiquement par PageHeader.render() -->

        <main class="main-content">
            <!-- S√©lecteur de taille -->
            <div class="difficulty-selector">
                <button class="difficulty-btn active" data-size="10x10">Standard (10x10)</button>
                <button class="difficulty-btn" data-size="15x15">Grand Format (15x15)</button>
            </div>

            <div class="game-area">
                <div id="crossword-grid"></div>

                <!-- Animation de victoire -->
                <div id="victory-overlay" class="victory-overlay">
                    <div class="victory-content">
                        <div class="victory-message">GAGN√â !</div>
                        <div class="confetti-container" id="confetti-container"></div>
                    </div>
                </div>
            </div>

            <div class="clues-container">
                <div class="clues-section">
                    <h3>Horizontal</h3>
                    <div id="horizontal-clues" class="clues-list"></div>
                </div>
                <div class="clues-section">
                    <h3>Vertical</h3>
                    <div id="vertical-clues" class="clues-list"></div>
                </div>
            </div>

            <div class="game-actions">
                <button class="btn-secondary" id="hint-btn">üí° Indice</button>
                <button class="btn-primary" id="new-game-btn">üîÑ Nouvelle grille</button>
            </div>
        </main>

        <!-- Toast pour les notifications -->
        <div id="toast" class="toast"></div>
    </div>

    <!-- Modale de configuration -->
    <div id="config-modal" class="config-modal-overlay">
        <div class="config-modal">
            <div class="config-modal-header">
                <span class="config-modal-icon">‚öôÔ∏è</span>
                <h2 class="config-modal-title">Configuration</h2>
            </div>

            <!-- Taille de la grille -->
            <div class="config-section">
                <h3 class="config-section-title">
                    üìê Taille de la grille
                </h3>
                <p class="config-section-description">
                    Choisis la taille de la grille. Plus elle est grande, plus il y aura de mots √† trouver.
                </p>
                <div class="grid-size-options" id="grid-size-options">
                    <!-- G√©n√©r√© dynamiquement -->
                </div>
            </div>

            <!-- S√©lection des th√®mes -->
            <div class="config-section">
                <h3 class="config-section-title">
                    üé® Th√®mes des mots
                </h3>
                <p class="config-section-description">
                    S√©lectionne les th√®mes dont tu veux que les mots soient tir√©s. Tu peux en s√©lectionner plusieurs. Les mots seront tir√©s al√©atoirement parmi les th√®mes choisis.
                </p>
                <div class="themes-list" id="themes-list">
                    <!-- G√©n√©r√© dynamiquement -->
                </div>
            </div>

            <!-- Actions -->
            <div class="config-modal-actions">
                <button id="config-cancel-btn" class="btn-secondary">Annuler</button>
                <button id="config-save-btn" class="btn-primary">Sauvegarder</button>
            </div>
        </div>
    </div>

    <!-- Scripts partag√©s -->
    <script src="../../shared/js/common.js"></script>
    <script src="../../shared/js/reward-badge.js"></script>
    <script src="../../shared/js/game-rating.js"></script>
    <script src="../../shared/js/game-rating-modal.js"></script>
    <script src="../../shared/js/game-help-modal.js"></script>
    <script src="../../shared/js/victory-animation.js"></script>

    <!-- Script du module -->
    <script src="js/crossword.js"></script>

    <!-- Initialisation -->
    <script>
        // Instance globale initialis√©e selon la taille s√©lectionn√©e
        let crosswordGame;

        window.addEventListener('common-scripts-loaded', async () => {
            await initializeApp(async () => {
                // Initialiser avec la taille par d√©faut (10x10)
                initCrosswordGame('10x10');

                // G√©rer le changement de taille
                document.querySelectorAll('.difficulty-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const size = btn.dataset.size;

                        // Mettre √† jour les boutons actifs
                        document.querySelectorAll('.difficulty-btn').forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');

                        // R√©initialiser avec la nouvelle taille
                        initCrosswordGame(size);
                    });
                });
            });
        });

        function initCrosswordGame(size) {
            const configs = {
                '10x10': {
                    gridSize: 10,
                    minWords: 12,
                    maxWords: 15,
                    minWordLength: 3,
                    maxWordLength: 8,
                    maxHints: 3,
                    maxAttemptsPerDay: 3,
                    baseCredits: 5,
                    gameType: 'crossword',
                    title: 'Mots Crois√©s',
                    subtitle: 'Grille 10x10 ‚Ä¢ 3 essais par jour',
                    icon: 'üî†'
                },
                '15x15': {
                    gridSize: 15,
                    minWords: 25,
                    maxWords: 35,
                    minWordLength: 3,
                    maxWordLength: 12,
                    maxHints: 5,
                    maxAttemptsPerDay: 2,
                    baseCredits: 10,
                    gameType: 'crossword-large',
                    title: 'Mots Crois√©s',
                    subtitle: 'Grille 15x15 ‚Ä¢ 2 essais par jour',
                    icon: 'üì∞'
                }
            };

            const config = configs[size];

            // Ajouter le badge de r√©compense dans la config
            config.reward = {
                baseCredits: config.baseCredits,
                bonusText: '+ bonus temps'
            };

            // Cr√©er une nouvelle instance avec la config appropri√©e
            crosswordGame = new CrosswordGame(config);
            crosswordGame.init();
        }
    </script>
</body>
</html>
